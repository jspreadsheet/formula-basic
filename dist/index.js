!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("@formulajs/formulajs"),require("jsuites")):"function"==typeof define&&define.amd?define(["@formulajs/formulajs","jsuites"],r):"object"==typeof exports?exports["formula-basic"]=r(require("@formulajs/formulajs"),require("jsuites")):e["formula-basic"]=r(e["@formulajs/formulajs"],e.jsuites)}(this,(function(e,r){return function(){var t={960:function(e,r,t){if(!n)var n=t(777);if(!o)var o=t(901);e.exports=function(){return function(e){function r(e,r){const t=r.split(".");let n=e;for(const e of t){if(null==n)return;n=n[e]}return n}for(let t=0;t<Object.keys(o).length;t++){let n,a=Object.keys(o)[t],l=[];if("object"==typeof o[a]){l=Object.keys(o[a]),n=Object.values(o[a]);for(let e=0;e<n.length;e++)if("object"==typeof n[e]){let r=l[e];o[a][r]&&(l=[...l,...Object.keys(o[a][r]).map((e=>r+"."+e))],l.splice(l.indexOf(r),1))}}if(l.length<1)e[a]=o[a];else for(let t=0;t<l.length;t++)"function"==typeof r(o[a],l[t])&&(e[a]=r(o[a],l[t]))}var t=null,a=null,l=null;e.TABLE=function(){return l},e.COLUMN=e.COL=function(){return l.tracking&&l.tracking.push(s.getColumnNameFromCoords(parseInt(t),parseInt(a))),parseInt(t)+1},e.ROW=function(){return l.tracking&&l.tracking.push(s.getColumnNameFromCoords(parseInt(t),parseInt(a))),parseInt(a)+1},e.CELL=function(){return s.getColumnNameFromCoords(t,a)},e.VALUE=function(e,r,t){return l.getValueFromCoords(parseInt(e)-1,parseInt(r)-1,t)},e.THISROWCELL=function(e){return l.getValueFromCoords(parseInt(e)-1,parseInt(a))};var u=function(e,r){for(var t=0;t<e.length;t++){var n=s.getTokensFromRange(e[t]);r=r.replace(e[t],"["+n.join(",")+"]")}return r},s=function(e,r,o,s,f){l=f,t=o,a=s;var i,c="",p={};if(r)if(r.size){d=null,r.forEach((function(e,r){-1!==(m=r.replace(/!/g,".")).indexOf(".")&&(m=m.split("."),p[m[0]]=!0)})),m=Object.keys(p);for(let e=0;e<m.length;e++)c+="var "+m[e]+" = {};";r.forEach((function(e,t){m=t.replace(/!/g,"."),null===e||n.isNumeric(e)||(d=e.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&d.length&&(e=updateRanges(d,e)),m.indexOf(".")>0?c+=m+" = "+r.get(t)+";\n":c+="var "+m+" = "+e+";\n"}))}else{var g=Object.keys(r);if(g.length){for(p={},o=0;o<g.length;o++)if((m=g[o].replace(/\!/g,".")).indexOf(".")>0){var m=m.split(".");p[m[0]]={}}for(m=Object.keys(p),o=0;o<m.length;o++)c+="var "+m[o]+" = {};";for(o=0;o<g.length;o++){if(m=g[o].replace(/\!/g,"."),null!==r[g[o]]&&(i=r[g[o]],isNaN(i)||null===i||""===i)){var d;(d=r[g[o]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&d.length&&(r[g[o]]=u(d,r[g[o]]));var v="'"+r[g[o]]+"'"}m.indexOf(".")>0?c+=m+" = "+(void 0===v?r[g[o]]:v)+";\n":c+="var "+m+" = "+(void 0===v?r[g[o]]:v)+";\n"}}}e=function(e,r){for(var t="",n=0,o=["=","!",">","<"],a=0;a<e.length;a++)'"'==e[a]&&(n=0==n?1:0),1==n?t+=e[a]:(t+=e[a].toUpperCase(),1==r&&a>0&&"="==e[a]&&-1==o.indexOf(e[a-1])&&-1==o.indexOf(e[a+1])&&(t+="="));return(t=(t=(t=t.replace(/\^/g,"**")).replace(/\<\>/g,"!=")).replace(/\&/g,"+")).replace(/\$/g,"")}(e=(e=e.replace(/\$/g,"")).replace(/\!/g,"."),!0),(d=e.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&d.length&&(e=u(d,e));var h=new Function(c+"; return "+e)();return null===h&&(h=0),h};return s.getColumnNameFromCoords=function(e,r){return t=parseInt(e),n="",t>701?(n+=String.fromCharCode(64+parseInt(t/676)),n+=String.fromCharCode(64+parseInt(t%676/26))):t>25&&(n+=String.fromCharCode(64+parseInt(t/26))),n+String.fromCharCode(65+t%26)+(parseInt(r)+1);var t,n},s.getCoordsFromColumnName=function(e){var r=/^[a-zA-Z]+/.exec(e);if(r){for(var t=0,n=0;n<r[0].length;n++)t+=parseInt(r[0].charCodeAt(n)-64)*Math.pow(26,r[0].length-1-n);--t<0&&(t=0);var o=parseInt(/[0-9]+$/.exec(e))||null;return o>0&&o--,[t,o]}},s.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var r="",t="",n=0;n<e.length;n++)e[n].indexOf(".")>=0?r=".":e[n].indexOf("!")>=0&&(r="!"),r&&(t=e[n].split(r),e[n]=t[1],t=t[0]+r);return e.sort((function(e,r){var t=Helpers.getCoordsFromColumnName(e),n=Helpers.getCoordsFromColumnName(r);return t[1]>n[1]?1:t[1]<n[1]?-1:t[0]>n[0]?1:t[0]<n[0]?-1:0})),e.length?t+(e[0]+":")+e[e.length-1]:"#REF!"},s.getTokensFromRange=function(e){if(e.indexOf(".")>0){var r=e.split(".");e=r[1],r=r[0]+"."}else e.indexOf("!")>0?(r=e.split("!"),e=r[1],r=r[0]+"!"):r="";e=e.split(":");var t=s.getCoordsFromColumnName(e[0]),n=s.getCoordsFromColumnName(e[1]);if(t[0]<=n[0])var o=t[0],a=n[0];else o=n[0],a=t[0];if(null===t[1]&&null==n[1])for(var l=null,u=null,f=Object.keys(vars),i=0;i<f.length;i++){var c=s.getCoordsFromColumnName(f[i]);c[0]===t[0]&&(null===l||c[1]<l)&&(l=c[1]),c[0]===n[0]&&(null===u||c[1]>u)&&(u=c[1])}else t[1]<=n[1]?(l=t[1],u=n[1]):(l=n[1],u=t[1]);for(var p=[],g=l;g<=u;g++){var m=[];for(i=o;i<=a;i++)m.push(r+s.getColumnNameFromCoords(i,g));p.push(m)}return p},s.setFormula=function(r){for(var t=Object.keys(r),n=0;n<t.length;n++)"function"==typeof r[t[n]]&&(e[t[n]]=r[t[n]])},s.basic=!0,s}(this)}()},901:function(r){"use strict";r.exports=e},777:function(e){"use strict";e.exports=r}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e].call(a.exports,a,a.exports,o),a.exports}var a={};return function(){"use strict";let e=o(960);window.formula=e,a.default=e}(),a.default}()}));