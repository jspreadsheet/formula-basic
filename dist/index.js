if (!formulajs && typeof require === 'function') {
    var formulajs = require('@formulajs/formulajs')
}
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports["formula-basic"]=r():e["formula-basic"]=r()}(this,(function(){return function(){var e={960:function(e){e.exports=function(){return function(e){function r(e,r){const n=r.split(".");let t=e;for(const e of n){if(null==t)return;t=t[e]}return t}for(let n=0;n<Object.keys(formulajs).length;n++){let t,o=Object.keys(formulajs)[n],l=[];if("object"==typeof formulajs[o]){l=Object.keys(formulajs[o]),t=Object.values(formulajs[o]);for(let e=0;e<t.length;e++)if("object"==typeof t[e]){let r=l[e];formulajs[o][r]&&(l=[...l,...Object.keys(formulajs[o][r]).map((e=>r+"."+e))],l.splice(l.indexOf(r),1))}}if(l.length<1)e[o]=formulajs[o];else for(let n=0;n<l.length;n++)"function"==typeof r(formulajs[o],l[n])&&(e[o]=r(formulajs[o],l[n]))}var n=null,t=null,o=null;e.TABLE=function(){return o},e.COLUMN=e.COL=function(){return o.tracking&&o.tracking.push(u.getColumnNameFromCoords(parseInt(n),parseInt(t))),parseInt(n)+1},e.ROW=function(){return o.tracking&&o.tracking.push(u.getColumnNameFromCoords(parseInt(n),parseInt(t))),parseInt(t)+1},e.CELL=function(){return u.getColumnNameFromCoords(n,t)},e.VALUE=function(e,r,n){return o.getValueFromCoords(parseInt(e)-1,parseInt(r)-1,n)},e.THISROWCELL=function(e){return o.getValueFromCoords(parseInt(e)-1,parseInt(t))};var l=function(e,r){for(var n=0;n<e.length;n++){var t=u.getTokensFromRange(e[n]);r=r.replace(e[n],"["+t.join(",")+"]")}return r},a=function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},u=function(e,r,u,f,s){o=s,n=u,t=f;var i="",c={};if(r)if(r.size){m=null,r.forEach((function(e,r){-1!==(g=r.replace(/!/g,".")).indexOf(".")&&(g=g.split("."),c[g[0]]=!0)})),g=Object.keys(c);for(let e=0;e<g.length;e++)i+="var "+g[e]+" = {};";r.forEach((function(e,n){g=n.replace(/!/g,"."),null===e||a(e)||(m=e.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&m.length&&(e=updateRanges(m,e)),g.indexOf(".")>0?i+=g+" = "+r.get(n)+";\n":i+="var "+g+" = "+e+";\n"}))}else{var p=Object.keys(r);if(p.length){for(c={},u=0;u<p.length;u++)if((g=p[u].replace(/\!/g,".")).indexOf(".")>0){var g=g.split(".");c[g[0]]={}}for(g=Object.keys(c),u=0;u<g.length;u++)i+="var "+g[u]+" = {};";for(u=0;u<p.length;u++){var m;g=p[u].replace(/\!/g,"."),null===r[p[u]]||a(r[p[u]])||(m=r[p[u]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&m.length&&(r[p[u]]=l(m,r[p[u]])),g.indexOf(".")>0?i+=g+" = "+r[p[u]]+";\n":i+="var "+g+" = "+r[p[u]]+";\n"}}}e=function(e,r){for(var n="",t=0,o=["=","!",">","<"],l=0;l<e.length;l++)'"'==e[l]&&(t=0==t?1:0),1==t?n+=e[l]:(n+=e[l].toUpperCase(),1==r&&l>0&&"="==e[l]&&-1==o.indexOf(e[l-1])&&-1==o.indexOf(e[l+1])&&(n+="="));return(n=(n=(n=n.replace(/\^/g,"**")).replace(/\<\>/g,"!=")).replace(/\&/g,"+")).replace(/\$/g,"")}(e=(e=e.replace(/\$/g,"")).replace(/\!/g,"."),!0),(m=e.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&m.length&&(e=l(m,e));var d=new Function(i+"; return "+e)();return null===d&&(d=0),d};return u.getColumnNameFromCoords=function(e,r){return n=parseInt(e),t="",n>701?(t+=String.fromCharCode(64+parseInt(n/676)),t+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(t+=String.fromCharCode(64+parseInt(n/26))),t+String.fromCharCode(65+n%26)+(parseInt(r)+1);var n,t},u.getCoordsFromColumnName=function(e){var r=/^[a-zA-Z]+/.exec(e);if(r){for(var n=0,t=0;t<r[0].length;t++)n+=parseInt(r[0].charCodeAt(t)-64)*Math.pow(26,r[0].length-1-t);--n<0&&(n=0);var o=parseInt(/[0-9]+$/.exec(e))||null;return o>0&&o--,[n,o]}},u.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var r="",n="",t=0;t<e.length;t++)e[t].indexOf(".")>=0?r=".":e[t].indexOf("!")>=0&&(r="!"),r&&(n=e[t].split(r),e[t]=n[1],n=n[0]+r);return e.sort((function(e,r){var n=Helpers.getCoordsFromColumnName(e),t=Helpers.getCoordsFromColumnName(r);return n[1]>t[1]?1:n[1]<t[1]?-1:n[0]>t[0]?1:n[0]<t[0]?-1:0})),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},u.getTokensFromRange=function(e){if(e.indexOf(".")>0){var r=e.split(".");e=r[1],r=r[0]+"."}else e.indexOf("!")>0?(r=e.split("!"),e=r[1],r=r[0]+"!"):r="";e=e.split(":");var n=u.getCoordsFromColumnName(e[0]),t=u.getCoordsFromColumnName(e[1]);if(n[0]<=t[0])var o=n[0],l=t[0];else o=t[0],l=n[0];if(null===n[1]&&null==t[1])for(var a=null,f=null,s=Object.keys(vars),i=0;i<s.length;i++){var c=u.getCoordsFromColumnName(s[i]);c[0]===n[0]&&(null===a||c[1]<a)&&(a=c[1]),c[0]===t[0]&&(null===f||c[1]>f)&&(f=c[1])}else n[1]<=t[1]?(a=n[1],f=t[1]):(a=t[1],f=n[1]);for(var p=[],g=a;g<=f;g++){var m=[];for(i=o;i<=l;i++)m.push(r+u.getColumnNameFromCoords(i,g));p.push(m)}return p},u.setFormula=function(r){for(var n=Object.keys(r),t=0;t<n.length;t++)"function"==typeof r[n[t]]&&(e[n[t]]=r[n[t]])},u.basic=!0,u}(this)}()}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var l=r[t]={exports:{}};return e[t].call(l.exports,l,l.exports,n),l.exports}var t={};return function(){"use strict";let e=n(960);window.formula=e,t.default=e}(),t.default}()}));